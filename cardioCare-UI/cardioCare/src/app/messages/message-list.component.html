<div class="inbox-container">

  <aside class="sidebar">
    <div class="sidebar-header">
      <h3>Mensajes</h3>
    </div>

    <div class="contact-list">
      <div *ngFor="let sender of senders"
           class="contact-item"
           [class.active]="selectedSender === sender"
           (click)="selectChat(sender)">

        <div class="avatar small" [style.background]="getAvatarColor(sender)">
          {{ getInitials(sender) }}
        </div>

        <div class="contact-info">
          <span class="contact-name">{{ sender }}</span>
          <span class="last-msg-preview">Haga clic para ver historial</span>
        </div>
      </div>
    </div>
  </aside>

  <main class="chat-area">

    <header class="chat-header" *ngIf="selectedSender">
      <div class="avatar" [style.background]="getAvatarColor(selectedSender)">
        {{ getInitials(selectedSender) }}
      </div>
      <div class="chat-title">
        <h2>{{ selectedSender }}</h2>
        <span class="status">Personal Médico</span>
      </div>
    </header>

    <div class="messages-feed" *ngIf="selectedSender; else emptyState">
      <div *ngFor="let msg of currentMessages" class="message-bubble-row">

        <div class="message-bubble received">
          <p>{{ msg.content }}</p>
          <div class="message-meta">
            <span>{{ msg.sentAt | date:'shortTime' }}</span>
            <span *ngIf="msg.tag" class="tag">{{ msg.tag }}</span>
          </div>
        </div>

      </div>
    </div>

    <ng-template #emptyState>
      <div class="empty-placeholder">
        <i class="far fa-paper-plane"></i>
        <p>Selecciona una conversación para leer</p>
      </div>
    </ng-template>

    <div class="chat-input-area" *ngIf="selectedSender">
      <input type="text" placeholder="No se puede responder a este mensaje automático" disabled>
    </div>

  </main>

</div>
